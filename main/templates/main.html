{% extends "base.html" %}
{% load humanize %}

{% block content %}
<!-- ... Hero kamu tetap ... -->

<section id="produk" class="py-12 sm:py-16">
  <div class="mx-auto max-w-7xl px-6">
    <div class="mb-6 flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between">
      <div>
        <h2 class="text-4xl font-bold tracking-tight">Premium Products</h2>
        <p class="mt-2 text-base" style="color:var(--muted-foreground)">
          Discover our carefully curated selection of pilates and wellness products to enhance your practice
        </p>
      </div>

      <!-- FILTER HARGA + SORT -->
      <form method="get" id="price-filter-form" class="flex flex-col gap-3 sm:flex-row sm:items-center">
        <!-- checkbox ranges -->
        <div class="flex flex-wrap items-center gap-3">
          {% for r in PRICE_RANGES %}
            <label class="inline-flex items-center gap-2">
              <input type="checkbox" name="price" value="{{ r.key }}" {% if r.checked %}checked{% endif %} />
              <span class="text-sm">{{ r.label }}</span>
            </label>
          {% endfor %}
        </div>

        <!-- select sort -->
        <div>
          <select name="order" class="rounded-xl border border-theme px-3 py-2 text-sm" onchange="this.form.submit()">
            <option value="">Urut default</option>
            <option value="price" {% if request.GET.order == 'price' %}selected{% endif %}>Harga termurah</option>
            <option value="-price" {% if request.GET.order == '-price' %}selected{% endif %}>Harga termahal</option>
          </select>
        </div>

        <!-- tombol apply & reset kalau mau manual -->
        <div class="flex items-center gap-2">
          <button type="submit" class="btn-primary rounded-xl px-4 py-2 text-sm">Terapkan</button>
          <a href="{% url 'main:show_main' %}#produk" class="btn-ghost rounded-xl px-4 py-2 text-sm">Reset</a>
        </div>
      </form>

      <script>
        // Auto-submit saat user mencentang / uncheck checkbox
        document.querySelectorAll('#price-filter-form input[type="checkbox"]').forEach(cb => {
          cb.addEventListener('change', () => {
            // tetap di anchor #produk setelah reload
            const form = document.getElementById('price-filter-form');
            form.action = window.location.pathname + '#produk';
            form.submit();
          });
        });
      </script>
    </div>

    <!-- GRID PRODUK -->
    <div class="grid gap-6 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3">
      {% for p in products %}
        {% include "product_card.html" %}
      {% empty %}
        <p style="color:var(--muted-foreground)">Belum ada produk.</p>
      {% endfor %}
    </div>
  </div>
</section>

<!-- ... Footer kamu tetap ... -->
{% endblock %}
